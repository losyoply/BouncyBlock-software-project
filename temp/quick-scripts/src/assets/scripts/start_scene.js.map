{"version":3,"sources":["assets\\scripts\\start_scene.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"/","sourcesContent":["const {ccclass, property} = cc._decorator;\r\n\r\n@ccclass\r\nexport default class start_scene extends cc.Component {\r\n\r\n    email_data: string;\r\n    password_data: string;\r\n    username: string;\r\n    uid: string;\r\n\r\n    onload() {\r\n        cc.debug.setDisplayStats(false);\r\n        if(firebase.auth().currentUser.uid) this.uid = firebase.auth().currentUser.uid;\r\n    }\r\n \r\n    start () {\r\n        cc.debug.setDisplayStats(false);\r\n\r\n        //cc.audioEngine.playMusic(this.bgm, true);\r\n        cc.find(\"Canvas/back\").on(cc.Node.EventType.MOUSE_DOWN, () => {\r\n            cc.director.loadScene('menu');\r\n        }, this);\r\n\r\n        this.email_data = \"\";\r\n        this.password_data = \"\";\r\n        this.username = \"\";\r\n/*\r\n        // var email = new cc.Component.EventHandler();\r\n        // email.target = this.node; //这个 node 节点是你的事件处理代码组件所属的节点\r\n        // email.component = \"start_scene\"\r\n        // email.handler = \"emailUpdate\";\r\n        // email.customEventData = \"foobar\";\r\n        // cc.find(\"Canvas/Email\").getComponent(cc.EditBox).textChanged.push(email);\r\n\r\n        // var n = new cc.Component.EventHandler();\r\n        // n.target = this.node; //这个 node 节点是你的事件处理代码组件所属的节点\r\n        // n.component = \"start_scene\"\r\n        // n.handler = \"nameUpdate\";\r\n        // n.customEventData = \"foobar\";\r\n        // cc.find(\"Canvas/Name\").getComponent(cc.EditBox).textChanged.push(n);\r\n\r\n        // var password = new cc.Component.EventHandler();\r\n        // password.target = this.node; //这个 node 节点是你的事件处理代码组件所属的节点\r\n        // password.component = \"start_scene\"\r\n        // password.handler = \"passwordUpdate\";\r\n        // password.customEventData = \"foobar\";\r\n        // cc.find(\"Canvas/Password\").getComponent(cc.EditBox).textChanged.push(password);\r\n*/\r\n        let signin = new cc.Component.EventHandler();\r\n        signin.target = this.node;\r\n        signin.component = \"start_scene\";\r\n        signin.handler = \"loadsignin\";\r\n        cc.find(\"Canvas/SignIn\").getComponent(cc.Button).clickEvents.push(signin);\r\n\r\n        let signup = new cc.Component.EventHandler();\r\n        signup.target = this.node;\r\n        signup.component = \"start_scene\";\r\n        signup.handler = \"loadsignup\";\r\n        cc.find(\"Canvas/SignUp\").getComponent(cc.Button).clickEvents.push(signup); \r\n\r\n    }\r\n    /*\r\n    // emailUpdate(text, editbox, customEventData) {\r\n    //     this.email_data = text;\r\n    //     //console.log(this.email_data);\r\n    // }\r\n    // nameUpdate(text, editbox, customEventData) {\r\n    //     this.username = text;\r\n    //     //console.log(this.email_data);\r\n    // }\r\n    // passwordUpdate(text, editbox, customEventData) {\r\n    //     this.password_data = text;\r\n    // }\r\n    */\r\n    loadsignin() {\r\n        this.password_data = cc.find(\"Canvas/Password\").getComponent(cc.EditBox).string;\r\n        this.email_data = cc.find(\"Canvas/Email\").getComponent(cc.EditBox).string;\r\n        //cc.audioEngine.playEffect(this.press, false);\r\n        firebase.auth().signInWithEmailAndPassword(this.email_data, this.password_data).then( (result) => {\r\n        /*\r\n            // firebase.database().ref('/users').once(\"value\").then( (snapshot) => {\r\n                // if(snapshot.child(this.uid).exists() == false) {\r\n                //     var a = {};\r\n                //     var tmp = {};\r\n                //     tmp['coins'] = 0;\r\n                //     tmp['email'] = firebase.auth().currentUser.email;\r\n                //     tmp['highscore'] = 0;\r\n                //     console.log('name = ', this.username)\r\n                //     tmp['name'] = this.username;\r\n                //     var t = {'lego':0, 'banana': 0, 'color': {1: true, 2: false, 3: false, 4: false, 5: false}, 'powerup': 0, 'signal': 0, 'mute': 0}\r\n                //     tmp['thing'] = t;\r\n                //     a[this.uid] = tmp;\r\n                //     firebase.database().ref('/users/').update(a);\r\n                // }\r\n                // this.scheduleOnce(()=>{\r\n        */\r\n                    this.password_data = '';\r\n                    this.email_data = '';\r\n                    cc.director.loadScene(\"menu\");\r\n                // }, 1);\r\n            // });\r\n        }).catch((error)=>{\r\n            alert(error);\r\n        });\r\n    }\r\n    loadsignup() {\r\n        this.username = cc.find(\"Canvas/Name\").getComponent(cc.EditBox).string;\r\n        this.password_data = cc.find(\"Canvas/Password\").getComponent(cc.EditBox).string;\r\n        this.email_data = cc.find(\"Canvas/Email\").getComponent(cc.EditBox).string;\r\n        //cc.audioEngine.playEffect(this.press, false);\r\n        //console.log(this.email_data, this.password_data);\r\n        console.log('name = ', this.username);\r\n        if(this.username == ''){\r\n            alert('Username cannot be empty.');\r\n            return;\r\n        }\r\n        firebase.auth().createUserWithEmailAndPassword(this.email_data, this.password_data).then( (result) => {\r\n            // firebase.database().ref('/users').once(\"value\").then( (snapshot)=> {\r\n                // if(snapshot.child(result.uid).exists() == false) {\r\n                    var tmp = {};\r\n                    tmp['coins'] = 0;\r\n                    tmp['email'] = this.email_data; //firebase.auth().currentUser.email;\r\n                    tmp['highscore'] = 0;\r\n                    tmp['name'] = this.username;\r\n                    console.log('name = ', this.username, this.email_data);\r\n                    var t = {'lego':0, 'banana': 0, 'color': {1:true, 2: false, 3: false, 4: false, 5: false}, 'powerup': 0, 'signal': 0, 'mute': 0}\r\n                    tmp['thing'] = t;\r\n                    firebase.database().ref('/users/' + result.user.uid).set(tmp, () =>{\r\n                        this.loadsignin();\r\n                    });\r\n            //     }\r\n            // });\r\n        }).catch((error)=>{\r\n            alert(error);\r\n        });\r\n    } \r\n}\r\n\r\n\r\n"]}